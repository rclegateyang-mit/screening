{
  "function": "compute_choice_probabilities",
  "worker_idx": 0,
  "inputs": {
    "gamma": 0.05,
    "beta": 0.2,
    "phi": 1.0,
    "mu_a": 0.0,
    "sigma_a": 1.5
  },
  "dimensions": {
    "N": 1000,
    "J": 10
  },
  "step1_cutoffs": {
    "c_nat": [
      5.230987919791887,
      13.354163124899502,
      8.199385536663764,
      10.103528198409162,
      9.722227464568643,
      4.568077331366739,
      17.289613010448406,
      13.21171015917241,
      11.492260681487313,
      11.345836332367162
    ],
    "w": [
      1.8499138520887013,
      2.3730744773560244,
      1.1186252421974243,
      2.248547435659582,
      2.617065967942723,
      3.1919261312941116,
      2.152429598994239,
      2.9344728296194877,
      2.642728369069495,
      2.864351216989539
    ],
    "Y": [
      94.4486488298036,
      298.17518820103214,
      1024.98351257716,
      126.0892216538969,
      104.11821270710053,
      56.576527596067,
      519.2058865788122,
      33.96475437632489,
      72.94191823382072,
      123.08985380689832
    ],
    "A": [
      1.292472734368979,
      0.9379464932616352,
      0.9718383489489486,
      0.9453808482339596,
      1.0594304837675894,
      2.011457107647177,
      0.7883351266302282,
      0.7260901583500378,
      0.8698434408615563,
      1.0406969096614689
    ],
    "formula": "log c_j = log w_j - log A_j - log(1-beta) + (beta/(1-beta))*(log Y_j - log A_j)"
  },
  "step2_ordering": {
    "order_idx": [
      5,
      0,
      2,
      4,
      3,
      9,
      8,
      7,
      1,
      6
    ],
    "inv_order": [
      5,
      0,
      2,
      4,
      3,
      9,
      8,
      7,
      1,
      6
    ],
    "c_sorted": [
      4.568077331366739,
      5.230987919791887,
      8.199385536663764,
      9.722227464568643,
      10.103528198409162,
      11.345836332367162,
      11.492260681487313,
      13.21171015917241,
      13.354163124899502,
      17.289613010448406
    ],
    "firm_ids": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10
    ],
    "firm_ids_by_c_order": [
      6,
      1,
      3,
      5,
      4,
      10,
      9,
      8,
      2,
      7
    ]
  },
  "step3_reindex": {
    "V_original": [
      3.0530371145600435,
      4.481973674376482,
      0.6149015791453986,
      4.0618046748887,
      4.816551654033692,
      5.920954448830434,
      3.982615696501604,
      5.240654355529796,
      5.023434844256884,
      5.194092210554094
    ],
    "V_sorted": [
      5.920954448830434,
      3.0530371145600435,
      0.6149015791453986,
      4.816551654033692,
      4.0618046748887,
      5.194092210554094,
      5.023434844256884,
      5.240654355529796,
      4.481973674376482,
      3.982615696501604
    ],
    "distances_worker0_original": [
      7.7857757549671955,
      6.939634877577553,
      14.936269036973664,
      11.519076185521445,
      11.575622698300613,
      7.533711243481545,
      9.307545667196125,
      8.21760960694487,
      7.853614024514319,
      7.944990902053052
    ],
    "distances_worker0_sorted": [
      7.533711243481545,
      7.7857757549671955,
      14.936269036973664,
      11.575622698300613,
      11.519076185521445,
      7.944990902053052,
      7.853614024514319,
      8.21760960694487,
      6.939634877577553,
      9.307545667196125
    ]
  },
  "step4_v_values": {
    "gamma": 0.05,
    "v_outside_worker0": 1.0,
    "neg_gamma_times_dist_worker0": [
      -0.3766855621740773,
      -0.3892887877483598,
      -0.7468134518486833,
      -0.5787811349150307,
      -0.5759538092760723,
      -0.3972495451026526,
      -0.39268070122571597,
      -0.41088048034724356,
      -0.34698174387887765,
      -0.46537728335980627
    ],
    "V_sorted_broadcasted": [
      5.920954448830434,
      3.0530371145600435,
      0.6149015791453986,
      4.816551654033692,
      4.0618046748887,
      5.194092210554094,
      5.023434844256884,
      5.240654355529796,
      4.481973674376482,
      3.982615696501604
    ],
    "exp_argument_worker0": [
      5.544268886656357,
      2.6637483268116835,
      -0.13191187270328475,
      4.237770519118661,
      3.485850865612628,
      4.796842665451441,
      4.630754143031168,
      4.8297738751825525,
      4.134991930497604,
      3.5172384131417975
    ],
    "v_firms_worker0": [
      255.76751482636365,
      14.34997681911559,
      0.8764182280453867,
      69.25328073075666,
      32.650196223504274,
      121.12737349676144,
      102.59140353636818,
      125.18265055007397,
      62.4890868125952,
      33.69125853782584
    ],
    "v_all_worker0": [
      1.0,
      255.76751482636365,
      14.34997681911559,
      0.8764182280453867,
      69.25328073075666,
      32.650196223504274,
      121.12737349676144,
      102.59140353636818,
      125.18265055007397,
      62.4890868125952,
      33.69125853782584
    ]
  },
  "step5_denominators": {
    "denom_worker0": [
      1.0,
      256.76751482636365,
      271.1174916454792,
      271.9939098735246,
      341.2471906042813,
      373.89738682778557,
      495.024760324547,
      597.6161638609152,
      722.7988144109892,
      785.2879012235844,
      818.9791597614103
    ],
    "explanation": "denom[k] = sum of v[0] through v[k] (cumulative sum)"
  },
  "step6_skill_processing": {
    "worker_idx": 0,
    "x_i": 7.437284489095588,
    "phi": 1.0,
    "mu_a": 0.0,
    "s_i": 7.437284489095588,
    "c_pad": [
      -Infinity,
      4.568077331366739,
      5.230987919791887,
      8.199385536663764,
      9.722227464568643,
      10.103528198409162,
      11.345836332367162,
      11.492260681487313,
      13.21171015917241,
      13.354163124899502,
      17.289613010448406,
      Infinity
    ],
    "sigma_a": 1.5
  },
  "step6_px_intervals": {
    "intervals": [
      {
        "k": 0,
        "c_lower": -Infinity,
        "c_upper": 4.568077331366739,
        "standardized_lower": -Infinity,
        "standardized_upper": -1.9128047718192327,
        "cdf_lower": 0.0,
        "cdf_upper": 0.027886525027105764,
        "p_x_k": 0.027886525027105764
      },
      {
        "k": 1,
        "c_lower": 4.568077331366739,
        "c_upper": 5.230987919791887,
        "standardized_lower": -1.9128047718192327,
        "standardized_upper": -1.4708643795358007,
        "cdf_lower": 0.027886525027105764,
        "cdf_upper": 0.07066389873929461,
        "p_x_k": 0.04277737371218885
      },
      {
        "k": 2,
        "c_lower": 5.230987919791887,
        "c_upper": 8.199385536663764,
        "standardized_lower": -1.4708643795358007,
        "standardized_upper": 0.5080673650454504,
        "cdf_lower": 0.07066389873929461,
        "cdf_upper": 0.6942969494520278,
        "p_x_k": 0.6236330507127332
      },
      {
        "k": 3,
        "c_lower": 8.199385536663764,
        "c_upper": 9.722227464568643,
        "standardized_lower": 0.5080673650454504,
        "standardized_upper": 1.523295316982037,
        "cdf_lower": 0.6942969494520278,
        "cdf_upper": 0.9361575808744355,
        "p_x_k": 0.24186063142240766
      },
      {
        "k": 4,
        "c_lower": 9.722227464568643,
        "c_upper": 10.103528198409162,
        "standardized_lower": 1.523295316982037,
        "standardized_upper": 1.7774958062090491,
        "cdf_lower": 0.9361575808744355,
        "cdf_upper": 0.962256649883091,
        "p_x_k": 0.02609906900865555
      },
      {
        "k": 5,
        "c_lower": 10.103528198409162,
        "c_upper": 11.345836332367162,
        "standardized_lower": 1.7774958062090491,
        "standardized_upper": 2.6057012288477157,
        "cdf_lower": 0.962256649883091,
        "cdf_upper": 0.9954156800516235,
        "p_x_k": 0.0331590301685325
      },
      {
        "k": 6,
        "c_lower": 11.345836332367162,
        "c_upper": 11.492260681487313,
        "standardized_lower": 2.6057012288477157,
        "standardized_upper": 2.7033174615944833,
        "cdf_lower": 0.9954156800516235,
        "cdf_upper": 0.9965674428172581,
        "p_x_k": 0.0011517627656345564
      },
      {
        "k": 7,
        "c_lower": 11.492260681487313,
        "c_upper": 13.21171015917241,
        "standardized_lower": 2.7033174615944833,
        "standardized_upper": 3.8496171133845483,
        "cdf_lower": 0.9965674428172581,
        "cdf_upper": 0.9999408486953616,
        "p_x_k": 0.0033734058781035303
      },
      {
        "k": 8,
        "c_lower": 13.21171015917241,
        "c_upper": 13.354163124899502,
        "standardized_lower": 3.8496171133845483,
        "standardized_upper": 3.9445857572026095,
        "cdf_lower": 0.9999408486953616,
        "cdf_upper": 0.9999600309784519,
        "p_x_k": 1.9182283090279917e-05
      },
      {
        "k": 9,
        "c_lower": 13.354163124899502,
        "c_upper": 17.289613010448406,
        "standardized_lower": 3.9445857572026095,
        "standardized_upper": 6.568219014235211,
        "cdf_lower": 0.9999600309784519,
        "cdf_upper": 0.9999999999745397,
        "p_x_k": 3.996899608782467e-05
      },
      {
        "k": 10,
        "c_lower": 17.289613010448406,
        "c_upper": Infinity,
        "standardized_lower": 6.568219014235211,
        "standardized_upper": Infinity,
        "cdf_lower": 0.9999999999745397,
        "cdf_upper": 1.0,
        "p_x_k": 2.5460300534518865e-11
      }
    ],
    "p_x_raw": [
      0.027886525027105764,
      0.04277737371218885,
      0.6236330507127332,
      0.24186063142240766,
      0.02609906900865555,
      0.0331590301685325,
      0.0011517627656345564,
      0.0033734058781035303,
      1.9182283090279917e-05,
      3.996899608782467e-05,
      2.5460300534518865e-11
    ],
    "p_x_sum_before_normalization": 1.0
  },
  "step6_px_normalization": {
    "p_x_clipped": [
      0.027886525027105764,
      0.04277737371218885,
      0.6236330507127332,
      0.24186063142240766,
      0.02609906900865555,
      0.0331590301685325,
      0.0011517627656345564,
      0.0033734058781035303,
      1.9182283090279917e-05,
      3.996899608782467e-05,
      2.5460300534518865e-11
    ],
    "p_x_sum": 1.0,
    "p_x_normalized": [
      0.027886525027105764,
      0.04277737371218885,
      0.6236330507127332,
      0.24186063142240766,
      0.02609906900865555,
      0.0331590301685325,
      0.0011517627656345564,
      0.0033734058781035303,
      1.9182283090279917e-05,
      3.996899608782467e-05,
      2.5460300534518865e-11
    ],
    "p_x_final_sum": 1.0
  },
  "step7_suffix_sum": {
    "denom_worker": [
      1.0,
      256.76751482636365,
      271.1174916454792,
      271.9939098735246,
      341.2471906042813,
      373.89738682778557,
      495.024760324547,
      597.6161638609152,
      722.7988144109892,
      785.2879012235844,
      818.9791597614103
    ],
    "q": [
      0.027886525027105764,
      0.00016659963290573032,
      0.0023002317073964862,
      0.0008892134075166289,
      7.648141794937348e-05,
      8.868484064534345e-05,
      2.326677083545155e-06,
      5.644770141941194e-06,
      2.653889672731632e-08,
      5.0897251855717615e-08,
      3.108784909976965e-14
    ],
    "Q_suffix_sum": [
      0.03141578491692448,
      0.0035292598898187194,
      0.003362660256912989,
      0.001062428549516503,
      0.00017321514199987415,
      9.673372405050068e-05,
      8.048883405157231e-06,
      5.722206321612077e-06,
      7.743617967088304e-08,
      5.089728294356672e-08,
      3.108784909976965e-14
    ],
    "v_worker": [
      1.0,
      255.76751482636365,
      14.34997681911559,
      0.8764182280453867,
      69.25328073075666,
      32.650196223504274,
      121.12737349676144,
      102.59140353636818,
      125.18265055007397,
      62.4890868125952,
      33.69125853782584
    ],
    "P_byc_worker": [
      0.03141578491692448,
      0.9026700311952999,
      0.048254096737262664,
      0.000931131746792084,
      0.011995716855735163,
      0.003158375071679162,
      0.000974940106448365,
      0.0005870491778588615,
      9.693666219672894e-06,
      3.1805247323857615e-06,
      1.0473887614052555e-12
    ],
    "P_byc_sum": 1.0
  },
  "step8_mapping": {
    "max_firm_id": 10,
    "P_nat_worker": [
      0.03141578491692448,
      0.048254096737262664,
      3.1805247323857615e-06,
      0.000931131746792084,
      0.003158375071679162,
      0.011995716855735163,
      0.9026700311952999,
      1.0473887614052555e-12,
      9.693666219672894e-06,
      0.0005870491778588615,
      0.000974940106448365
    ],
    "mapping_steps": [
      {
        "byc_pos": 0,
        "original_firm_idx": 5,
        "firm_id": 6,
        "P_byc_value": 0.9026700311952999,
        "P_nat_index": 6
      },
      {
        "byc_pos": 1,
        "original_firm_idx": 0,
        "firm_id": 1,
        "P_byc_value": 0.048254096737262664,
        "P_nat_index": 1
      },
      {
        "byc_pos": 2,
        "original_firm_idx": 2,
        "firm_id": 3,
        "P_byc_value": 0.000931131746792084,
        "P_nat_index": 3
      },
      {
        "byc_pos": 3,
        "original_firm_idx": 4,
        "firm_id": 5,
        "P_byc_value": 0.011995716855735163,
        "P_nat_index": 5
      },
      {
        "byc_pos": 4,
        "original_firm_idx": 3,
        "firm_id": 4,
        "P_byc_value": 0.003158375071679162,
        "P_nat_index": 4
      },
      {
        "byc_pos": 5,
        "original_firm_idx": 9,
        "firm_id": 10,
        "P_byc_value": 0.000974940106448365,
        "P_nat_index": 10
      },
      {
        "byc_pos": 6,
        "original_firm_idx": 8,
        "firm_id": 9,
        "P_byc_value": 0.0005870491778588615,
        "P_nat_index": 9
      },
      {
        "byc_pos": 7,
        "original_firm_idx": 7,
        "firm_id": 8,
        "P_byc_value": 9.693666219672894e-06,
        "P_nat_index": 8
      },
      {
        "byc_pos": 8,
        "original_firm_idx": 1,
        "firm_id": 2,
        "P_byc_value": 3.1805247323857615e-06,
        "P_nat_index": 2
      },
      {
        "byc_pos": 9,
        "original_firm_idx": 6,
        "firm_id": 7,
        "P_byc_value": 1.0473887614052555e-12,
        "P_nat_index": 7
      }
    ],
    "P_nat_sum": 1.0000000000000002
  }
}